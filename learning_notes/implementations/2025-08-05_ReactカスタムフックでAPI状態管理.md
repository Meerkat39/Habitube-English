# React カスタムフックで API 取得・状態管理を共通化する

## 📅 学習日時

2025 年 8 月 5 日

## ✅ 結論

React のカスタムフック（useWatchedVideoList）を使うことで、API 取得・ローディング・エラー・データ状態の管理を UI コンポーネントから切り離し、再利用性・可読性・保守性を高められる。

## 🧠 詳細

### カスタムフックの役割

- API 取得ロジック（fetch、状態管理）を隠蔽し、UI 側では「状態（data, loading, error）」のみを扱える
- 取得中は loading、失敗時は error、成功時は data で UI 制御が可能
- useEffect, useState などの React フックを組み合わせて実装

### 実装例

```typescript
export function useWatchedVideoList(month: string) {
  const [data, setData] = useState<WatchedVideoListResponse | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    setLoading(true);
    setError(null);
    fetchWatchedVideoList(month)
      .then(setData)
      .catch((e) => setError(e.message))
      .finally(() => setLoading(false));
  }, [month]);

  return { data, loading, error };
}
```

### UI 側での使い方

```typescript
const { data, loading, error } = useWatchedVideoList(month);
if (loading) return <Spinner />;
if (error) return <ErrorMessage msg={error} />;
return <Calendar data={data} />;
```

### ポイント

- UI コンポーネントは「状態」だけを意識すればよく、API 取得の詳細は気にしなくてよい
- 複数箇所で同じ API 取得ロジックを使い回せる
- useEffect 以外にも useState, useRef, useCallback 等を組み合わせて高度なカスタムフックが作れる

---

#### 分類: implementations（具体的なコード実装・API 設計）

ファイル名: `2025-08-05_ReactカスタムフックでAPI状態管理.md`
